# key值

1. key值的使用
   1. 在遍历数据得到多个节点的时候,需要给每个节点都添加上一个唯一的key值
2. 常用作key值的数据有哪些?
   1. 遍历得到的数据身上的唯一标识,例如:id,vid,userId等
   2. 遍历得到的数据的下标,例如:index
   3. 遍历得到的数据本身,例如:item
3. key值的作用
   1. 与diff算法有关
   2. 当遍历的数据发生变化的时候,Vue会创建全新的虚拟DOM树,然后与旧的虚拟DOM树进行对比,找到可以复用的旧的真实DOM节点(而key值就是比较的关键)
   3. first render(首次渲染):
      1. 解析template模版,将其编译为render函数
      2. 将当前最新的数据传入render函数,那么render函数就会返回出最新的虚拟DOM
      3. 根据返回的虚拟DOM,创建对应的真实DOM
      4. 将真实DOM插入到页面上
      5. 最终GUI线程会根据最新的html,渲染给用户观看
      6. **注意:首次渲染中,没有diff算法参与**
   4. update render(更新渲染):
      1. 将当前最新的数据,传入render函数,生成最新的虚拟DOM
      2. **比较新旧虚拟DOM,找到可以复用的真实DOM**
      3. **如果没找到可以复用的真实DOM,直接创建全新的真实DOM**
      4. **经过以上流程,最终合并所有的真实DOM,会获得一棵最新的真实DOM树**
      5. 将得到的最新的真实DOM树,替换掉页面上的指定区域
      6. 最终GUI线程会根据最新的html,渲染给用户观看
      7. 总结:流程2,3,4就是diff算法
         1. diff算法就是在找到没有变化的节点,防止误杀情况的出现
         2. diff算法只会**同级比较**,因为跨层级比较性能代价太大了
4. 如果使用下标作为key值,可能会出现什么问题?
   1. 如果遍历数据不更新,key值用下标也不会出现问题
      1. 因为首次渲染中,没有diff算法参与
   2. input案例
      1. 在input案例中,diff算法生效了,她的确在比较虚拟DOM,而且也复用了真实DOM,但是很可惜复用错了
         1. 功能才是最重要的,性能其次
   3. 商品排序案例
      1. 在商品排序案例中,diff算法生效了,他的确在比较虚拟DOM,但是由于用下标作为key值,导致本来可以复用的节点全部复用失败,复用失败的结果就是全部生成全新的真实DOM
         1. 在这个案例中,diff算法不仅没有优化性能,反而劣化了代码性能
5. 使用唯一标识作为key值的好处是什么?
   1. 只要服务器端的数据没有发生变化,那么前端的节点就可以一直复用下去