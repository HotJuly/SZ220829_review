<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
    /*
        1.什么是跨域?
            违反了浏览器的同源策略
            问题:什么是同源?
            回答:两个URL的协议名,域名(主机地址),端口号都相同的话,这连个URL就是同源的
            
            URL的组成部分:协议名+域名(主机地址)+端口号+查询字符串
                查询字符串由路径和参数组成
                例如:https://www.baidu.com:443/home?username=xiaoming

            例子1:由于协议名不同,所以不同源
                http://localhost:3000/home
                ftp://localhost:3000/home

            例子2:由于域名部分不相同,所以不同源
                http://localhost:3000/home
                http://127.0.0.1:3000/home

            例子3:由于协议名不同,所以不同源
                http://localhost:3000/home
                https://localhost:3000/home

            例子4:由于查询字符串不再同源判断标准之内,所以同源
                http://localhost:3000/home?a=2
                http://localhost:3000/about?a=1

            扩展:http协议的默认端口是80,https协议的默认端口是443

            扩展问题:跨域是否一定会报错?
                回答:不一定
                    -img/video/audio/link/script等标签,跨域请求不报错
                    -服务器之间跨域不报错

                    跨域其实是一种操作,该操作并不一定会得到严重的结果

                问题:什么时候跨域请求会报错?
                回答:
                    只有在浏览器中,使用ajax发送请求的时候,才会出现跨域报错
        
        2.为什么要有跨域报错?
            为了保证用户的数据安全,是一种安全策略
            假设跨域请求,不报错,可能出现的问题:
                前言:真网站称为A网站,假网站称为B网站
            1.用户请求B网站的服务器,那么对方服务器就会将html文件返回给浏览器
            2.用户的浏览器会展示B网站的网页
            3.B网站会使用ajax,携带上A网站的cookie数据,向A网站服务器发送请求
            4.A网站服务器接收到请求之后,根据cookie数据,确定用户身份,并返回用户重要数据
            5.B网站成功接收到用户重要数据之后,再使用ajax请求,将数据发回给B网站的服务器

            总结:这个过程中,用户的数据丢失了,A网站虽然没有丢失太多的东西,但是信誉受损
                最终导致互联网环境变差,大家都不敢上网了

        3.怎么解决跨域问题?
            1.JSONP
                原理:使用了script标签,跨域请求服务器不会报错的效果实现的
                流程:
                    1.前端网页中,需要准备好存储数据的变量(data),还有接收数据的函数(getData)
                    
                    2.当用户点击按钮的时候,创建一个script标签,并给该script标签添加src属性
                        src的属性值是数据服务器的某个接口地址,在地址中使用query将前端的getData函数名传递给服务器

                    3.服务器接收到前端传递的函数名称getData,并根据需要返回的数据,拼接成一个全新的字符串
                        例如:"getData(数据)"

                    4.服务器将拼接好的字符串,返回给前端的script标签

                    5.最终,script标签会将返回的文本内容,作为js代码,自动执行

                优点:
                    1.上线之后,依旧可以使用

                缺点:
                    1.前端需要准备好变量和接收数据的函数,以及script标签
                        后端还要专门写接口去拼接返回的文本内容
                        总结:该方案前后端都要忙,很麻烦

                    2.该方案只能发送GET请求

            2.CORS(跨域资源共享)
                原理:跨域问题是浏览器搞的鬼
                    浏览器怕服务器与用户会有数据损失,所以做了一层检查

                流程:
                    1.服务器在返回响应的时候,在响应头中,添加配置,来告知浏览器,愿意被当前域名请求即可
                        Access-Control-Allow-Origin: https://www.baidu.com

                优点:
                    1.前端什么事情都不需要做,很方便
                    2.该方案上线之后也可以使用

            3.proxy
                原理:该方案实现了开发服务器转发请求的功能,解决跨域问题
                流程:
                    1.在项目启动之前,配置到proxy相关规则,告知开发服务器,哪些开头的请求需要转发
                    
                    2.前端网页,请求开发服务器,路径为"/api/getData"
                        由于流程1中,已经通过proxy配置,告知了开发服务器/api开头的请求,都要转发
                        转发到target地址上

                    3.开发服务器在转发请求给target服务器的时候,会对路径进行重写,将/api去除
                        可以通过proxy规则的pathRewrite进行控制

                    4.target服务器接收到请求之后,他返回数据给开发服务器

                    5.开发服务器再将请求得到的数据返回给前端网页

                优点:
                    1.不求人,只需要前端配置少量代码即可

                缺点:
                    1.上线之后,无法使用




    */
    </script>
</body>
</html>